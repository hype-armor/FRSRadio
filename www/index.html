
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
<script src="js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="js/gauge.min.js"></script>

  <link href="css/std.css" rel="stylesheet">
  <title></title>

  <script type='text/javascript'>
    function loadtemp() {
      $.get('/data', function(data) {
        text = data.split(",");

        i = 0;

        // known data points
        rpm = text[i++];
        accelerator = text[i++];
        brake = text[i++];
        clutchStatus = text[i++];
        fuelFlow = text[i++];
        gear = text[i++];
        mph = text[i++];
        steeringAngle = text[i++];
        pitch = text[i++];
        roll = text[i++];
        sportMode = text[i++];
        oiltemp = text[i++];
        coolenttemp = text[i++];

        // unknowns
        zero = text[13]; // load?
        one = text[14]; // probably rpm.
        two = text[15];
        three = text[16];
        four = text[17];
        five = text[18];
        six = text[19];
        seven = text[20];

        threads--;
      }, "text").fail(function() {
        skip = 20;
        threads--;
      });
    };

    window.onload = function() {
      $('#splashscreen').fadeOut(2000).promise().done(function() {
        $('#content').hide();
        $('#content').fadeIn(2000);
        $('.labels').fadeIn(2000);
        $('.values').fadeIn(2000);

        skip = 0;
        threads = 0;
        setInterval(function() {
          if (skip == 0 && threads <= 16) {
            threads++;
            loadtemp();

            gauge.set(rpm); // set actual value
            $('#valzero').text(rpm);
            gauge1.set(fuelFlow); // set actual value
            $('#valone').text(fuelFlow);
            gauge2.set(oiltemp); // set actual value
            $('#valtwo').text(oiltemp);
            gauge3.set(coolenttemp); // set actual value
            $('#valthree').text(coolenttemp);
            gauge4.set(zero); // set actual value
            $('#valfour').text(zero);
            gauge5.set(one); // set actual value
            $('#valfive').text(one);
          } else if (skip > 0) {
            skip--;
          }
          $('#threads').text('Thread Count: ' + threads);
          $('#data').text(text);
        }, 100);

        $('#temperature').load('/temperature')
        $('#loadavg').load('/loadavg')
        setInterval(function() {
          $('#temperature').load('/temperature')
          $('#loadavg').load('/loadavg')
        }, 30000);
      });

      var opts = {
        angle: 0.001, // The span of the gauge arc
        lineWidth: 0.44, // The line thickness
        radiusScale: 1, // Relative radius
        pointer: {
          length: 0.13, // // Relative to gauge radius
          strokeWidth: 0.035, // The thickness
          color: '#000000' // Fill color
        },
        limitMax: false, // If false, the max value of the gauge will be updated if value surpass max
        limitMin: false, // If true, the min value of the gauge will be fixed unless you set it manually
        colorStart: '#4286f4', // Colors
        colorStop: '#4286f4', // just experiment with them
        strokeColor: '#555555', // to see which ones work best for you
        generateGradient: false,
        highDpiSupport: false // High resolution support
      };

      animationSpeed = 1
      var target = document.getElementById('zero'); // your canvas element
      var gauge = new Gauge(target).setOptions(opts); // create sexy gauge!
      gauge.maxValue = 3000; // set max gauge value
      gauge.setMinValue(0); // Prefer setter over gauge.minValue = 0
      gauge.animationSpeed = animationSpeed; // set animation speed (32 is default value)
      gauge.set(1250); // set actual value

      var target1 = document.getElementById('one'); // your canvas element
      var gauge1 = new Gauge(target1).setOptions(opts); // create sexy gauge!
      gauge1.maxValue = 3000; // set max gauge value
      gauge1.setMinValue(0); // Prefer setter over gauge.minValue = 0
      gauge1.animationSpeed = animationSpeed; // set animation speed (32 is default value)
      gauge1.set(1250); // set actual value

      var target2 = document.getElementById('two'); // your canvas element
      var gauge2 = new Gauge(target2).setOptions(opts); // create sexy gauge!
      gauge2.maxValue = 3000; // set max gauge value
      gauge2.setMinValue(0); // Prefer setter over gauge.minValue = 0
      gauge2.animationSpeed = animationSpeed; // set animation speed (32 is default value)
      gauge2.set(1250); // set actual value

      var target3 = document.getElementById('three'); // your canvas element
      var gauge3 = new Gauge(target3).setOptions(opts); // create sexy gauge!
      gauge3.maxValue = 3000; // set max gauge value
      gauge3.setMinValue(0); // Prefer setter over gauge.minValue = 0
      gauge3.animationSpeed = animationSpeed; // set animation speed (32 is default value)
      gauge3.set(1250); // set actual value

      var target4 = document.getElementById('four'); // your canvas element
      var gauge4 = new Gauge(target4).setOptions(opts); // create sexy gauge!
      gauge4.maxValue = 3000; // set max gauge value
      gauge4.setMinValue(0); // Prefer setter over gauge.minValue = 0
      gauge4.animationSpeed = animationSpeed; // set animation speed (32 is default value)
      gauge4.set(1250); // set actual value

      var target5 = document.getElementById('five'); // your canvas element
      var gauge5 = new Gauge(target5).setOptions(opts); // create sexy gauge!
      gauge5.maxValue = 3000; // set max gauge value
      gauge5.setMinValue(0); // Prefer setter over gauge.minValue = 0
      gauge5.animationSpeed = animationSpeed; // set animation speed (32 is default value)
      gauge5.set(1250); // set actual value
    }

  </script>

    
  </head>

  <body>
    <div id="spacer"><div id="threads">Starting up....</div></div>
    <div id="splashscreen" style="height: 480px;">
      <div id="spacer"></div>
      <img src="img/frs.png" />
    </div>
    
    <table id="content" style="width:480px">
      <tr>
        <th>RPM</th>
        <th>Fuel Flow</th>
        <th>Oil</th>
      </tr>
      <tr>
        <td>
          <canvas id="zero" style="border:1px solid #000000;"></canvas>
          <div class="values" id="valzero"></div>
        </td>
        <td>
          <canvas id="one" style="border:1px solid #000000;"></canvas>
          <div class="values" id="valone"></div>
        </td>
        <td>
          <canvas id="two" style="border:1px solid #000000;"></canvas>
          <div class="values" id="valtwo"></div>
        </td>
      </tr>
      <tr>
        <th>Coolent</th>
        <th>zero</th>
        <th>one</th>
      </tr>
      <tr>
        <td>
          <canvas id="three" style="border:1px solid #000000;"></canvas>
          <div class="values" id="valthree"></div>
        </td>
        <td>
          <canvas id="four" style="border:1px solid #000000;"></canvas>
          <div class="values" id="valfour"></div>
        </td>
        <td>
          <canvas id="five" style="border:1px solid #000000;"></canvas>
          <div class="values" id="valfive"></div>
        </td>
      </tr>
    </table>

    <div id="data">Debug data will load here.</div>
    <div id="temperature">41Â°C</div>
    <div id="loadavg">CPU: 100%</div>
  </body>
</html>

